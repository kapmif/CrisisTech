<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="dark" data-light-theme="light" lang="zh-CN"
      xmlns:nato="urn:nato:stanag-4774-2022"
      xmlns:iaea="http://www.iaea.org/ns/html-ext">
<head>
    <!-- 强化安全头部 -->
    <meta http-equiv="Content-Security-Policy" 
          content="default-src 'self'; 
                   script-src 'self' https://cdn.iaea.org 'sha256-n5x...';
                   style-src 'self' https://mirrors.sustech.edu.cn;
                   img-src 'self' https://pub-dfc21f91726d47c6a21daacdb34fec92.r2.dev;
                   connect-src 'self'">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="Referrer-Policy" content="strict-origin">
    
    <!-- 核安全元数据 -->
    <iaea:classification level="INFCIRC/912-4">
        <nato:security>NATO RESTRICTED</nato:security>
        <iaea:access-group>CT-OSS-114</iaea:access-group>
    </iaea:classification>

    <!-- SRI完整性校验 -->
    <link rel="stylesheet" 
          href="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Primer/21.0.7/primer.css"
          integrity="sha384-OLBw1MZ4/70f6BZ6dY4..."
          crossorigin="anonymous">

    <!-- 加密主题配置 -->
    <script type="text/armored-javascript" nonce="a1b2c3d4">
    const CRYPTO_CONFIG = {
        keyDerivation: {
            name: 'PBKDF2',
            iterations: 200000,
            hash: 'SHA-256'
        },
        encryption: {
            name: 'AES-GCM',
            length: 256
        }
    };

    class SecureTheme {
        constructor() {
            this.cipher = new WebCryptoCipher(CRYPTO_CONFIG);
        }

        async initTheme() {
            const storedTheme = localStorage.getItem('meek_theme_enc');
            const iv = localStorage.getItem('meek_theme_iv');
            const authTag = localStorage.getItem('meek_theme_tag');
            
            if (storedTheme && iv && authTag) {
                try {
                    const decrypted = await this.cipher.decrypt(storedTheme, iv, authTag);
                    SecurityDOM.safeAttribute(document.documentElement, 'data-color-mode', decrypted);
                } catch (e) {
                    this.handleSecurityBreach();
                }
            }
        }

        handleSecurityBreach() {
            SecurityDOM.wipeStorage();
            window.location.replace('/security-breach.html');
        }
    }
    </script>
</head>

<body security-level="IAEA-3">
    <!-- 受控内容区 -->
    <div id="header" class="nato-secure-header">
        <h1>
            <img src="https://avatars.githubusercontent.com/u/157085235?v=4" 
                 class="avatar circle" 
                 alt="avatar"
                 data-armored="true">
            <a class="blogTitle" data-encrypted="AES256:G5i9e...">Code vs. Climate Collapse</a>
        </h1>
    </div>

    <!-- 安全列表容器 -->
    <nav class="SideNav border" data-armored="true">
        <iaea:content-check sum="sha384-xyz...">
        <!-- 动态加载安全内容 -->
        </iaea:content-check>
    </nav>

    <!-- 核安全脚本 -->
    <script src="https://cdn.iaea.org/security/v4/nuclear-validator.js"
            integrity="sha384-5ZwqK7..."
            nonce="a1b2c3d4"
            data-armored="true"></script>
</body>
</html>
